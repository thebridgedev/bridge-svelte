name: Sync Docs (Manual + Auto)

on:
  # ‚ë† Manual trigger
  workflow_dispatch:

  # ‚ë° Auto trigger when docs change on main
  push:
    branches: [ main ]
    paths:
      - "learning/**/*.md"
      - "learning/**/*.mdx"
      - "README.md"

  # ‚ë¢ Allow testing on other branches (temporary for development)
  push:
    branches: [ "test/**", "fix/**", "feature/**" ]
    paths:
      - "learning/**/*.md"
      - "learning/**/*.mdx"
      - "README.md"
      - ".github/actions/sync-docs/action.yml"
      - ".github/workflows/sync-docs-only.yml"

permissions:
  contents: read

jobs:
  sync:
    name: üîÑ Sync Learning Docs to Bridge Web
    runs-on: ubuntu-latest
    steps:
      - name: ‚¨áÔ∏è Checkout repo
        uses: actions/checkout@v4
      - name: üîÑ Sync Docs
        uses: ./.github/actions/sync-docs
        env:
          DOCS_SYNC_SSH_KEY: ${{ secrets.DOCS_SYNC_SSH_KEY }}
